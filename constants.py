import numpy as np

refractive_index_list = np.array([1.5308, 1.5296, 1.5283, 1.5274, 1.5263, 1.5253,  # 400~450nm
                                  1.5245, 1.5236, 1.5228, 1.5221, 1.5214, 1.5208,  # 460~510nm
                                  1.52015, 1.5196, 1.5190, 1.5185, 1.518, 1.5175,  # 520~570nm
                                  1.51707, 1.5167, 1.5163, 1.51585, 1.51545, 1.5151,  # 580~630nm
                                  1.5148, 1.51445, 1.51415, 1.51385, 1.5135, 1.51324,  # 640~690nm
                                  1.5131])  # 700nm

wave_length_list_400_700nm = np.array([400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550,
                                       560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700]) * 1e-9

wave_length_list_420_720nm = np.array([420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570,
                                       580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710, 720]) * 1e-9

SRF_BFS_U3_88S6C_BGR_31_CHANNEL_400_700NM = [
    [25.48056926, 32.0295047, 36.2201465, 40.31518369, 44.74030595, 47.14851744, 46.65955711, 44.97380174, 42.26016774,
     35.50004653, 28.03846041, 20.29787608, 13.70564397, 9.722325144, 7.231906373, 4.967853628, 3.202065046,
     2.184233507, 1.836285129, 1.586892531, 1.358943904, 1.135153799, 1.227590476, 1.478570507, 1.995882243,
     2.721188174, 3.229119508, 3.179894938, 2.283567161, 1.348137444, 0.724738245],
    [4.541990956, 3.663623834, 2.940528853, 2.403136639, 3.178005198, 3.453126694, 4.85343158, 14.03512197, 33.39800734,
     47.62034583, 54.48847378, 57.59346551, 58.32896981, 59.49236532, 58.14619524, 56.9795439, 54.01251751, 51.14137543,
     46.72132402, 40.14084711, 31.86925929, 22.59998581, 16.07258693, 12.67019122, 10.94002049, 9.722541053,
     8.643719849, 8.110262677, 6.516759071, 4.425741173, 2.760398465],
    [5.768328514, 4.374139336, 3.385539552, 2.621414425, 2.07330116, 1.541177365, 1.318625695, 1.475911458, 1.635881235,
     1.54427472, 1.674356288, 2.498723416, 3.924646443, 4.700923391, 3.323684517, 2.241798618, 2.227311666, 5.092952135,
     23.88502721, 49.5733748, 56.31405836, 55.62174719, 54.09312688, 52.67057051, 51.95888314, 51.70757456, 45.98410239,
     37.76307594, 22.96991029, 11.93699506, 6.234105082]
]

SRF_GS3_U3_41S4C_BGR_31_CHANNEL_400_700NM = [
    [18.73589729, 28.27536788, 34.26532218, 38.89578098, 43.92060554, 48.2447291, 49.34113124, 48.42053339, 45.65638999,
     39.93330299, 32.29464007, 23.01558074, 15.2443332, 10.07552324, 7.201548122, 5.080157997, 3.264370381, 2.297836673,
     1.812185775, 1.52638278, 1.125983598, 0.806662059, 0.587345148, 0.537235367, 0.686925654, 1.03072496, 1.226171082,
     1.139780943, 0.623173653, 0.374706952, 0.244239498],
    [6.425137553, 7.446242762, 8.096116496, 8.900800174, 10.36405115, 12.03762611, 14.42202255, 19.65569408,
     25.23192339, 28.83286975, 33.85398281, 42.82070851, 53.13000898, 59.61325583, 61.75104661, 59.59523025,
     53.90891291, 47.30047763, 40.19970471, 32.09065727, 23.35397023, 15.10836029, 9.611802365, 6.887123842,
     5.589670348, 5.345366907, 4.950957308, 4.0502356, 2.583613336, 1.465660475, 0.684460275],
    [7.111793475, 5.795795295, 4.319709787, 3.166535783, 2.451689508, 2.011189415, 1.765684355, 2.010858585,
     2.201868624, 2.451063484, 2.659444915, 3.44220031, 5.054634739, 6.803908502, 6.245753758, 4.315452, 4.102605146,
     5.592691346, 16.81750851, 41.22101035, 54.5222667, 56.03542013, 53.9843276, 50.13648326, 48.50472486, 46.65697227,
     42.49659626, 29.31238995, 14.30632494, 5.929299276, 2.348298176]
]

SRF_GS3_U3_41S4C_BGR_31_CHANNEL_420_720NM = [
    [34.26532218, 38.89578098, 43.92060554, 48.2447291, 49.34113124, 48.42053339, 45.65638999,
     39.93330299, 32.29464007, 23.01558074, 15.2443332, 10.07552324, 7.201548122, 5.080157997, 3.264370381, 2.297836673,
     1.812185775, 1.52638278, 1.125983598, 0.806662059, 0.587345148, 0.537235367, 0.686925654, 1.03072496, 1.226171082,
     1.139780943, 0.623173653, 0.374706952, 0.244239498, 0.19618741, 0.19618741],
    [8.096116496, 8.900800174, 10.36405115, 12.03762611, 14.42202255, 19.65569408,
     25.23192339, 28.83286975, 33.85398281, 42.82070851, 53.13000898, 59.61325583, 61.75104661, 59.59523025,
     53.90891291, 47.30047763, 40.19970471, 32.09065727, 23.35397023, 15.10836029, 9.611802365, 6.887123842,
     5.589670348, 5.345366907, 4.950957308, 4.0502356, 2.583613336, 1.465660475, 0.684460275, 0.44380837, 0.34332796],
    [4.319709787, 3.166535783, 2.451689508, 2.011189415, 1.765684355, 2.010858585,
     2.201868624, 2.451063484, 2.659444915, 3.44220031, 5.054634739, 6.803908502, 6.245753758, 4.315452, 4.102605146,
     5.592691346, 16.81750851, 41.22101035, 54.5222667, 56.03542013, 53.9843276, 50.13648326, 48.50472486, 46.65697227,
     42.49659626, 29.31238995, 14.30632494, 5.929299276, 2.348298176, 0.83657815, 0.59286653]
]

SRF_MOCK_BGR_31_CHANNEL_400_700NM = [
    # 400    410    420    430    440    450    460    470    480    490    500    510    520    530    540   550nm
    [0.005, 0.007, 0.012, 0.015, 0.023, 0.030, 0.026, 0.024, 0.019, 0.010, 0.004, 0.00000001, 0.00000001, 0.00000001,
     0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001,
     0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001],
    [0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.001, 0.002, 0.003, 0.005, 0.007, 0.012, 0.013, 0.015,
     0.016, 0.017, 0.020, 0.013, 0.011, 0.009, 0.005, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.002,
     0.002, 0.003],
    [0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001,
     0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.001, 0.003, 0.010, 0.012,
     0.013, 0.022, 0.020, 0.020, 0.018, 0.017, 0.016, 0.016, 0.014, 0.014, 0.013]
]

SRF_SAPPHIRE_S25A30CL_GRAY_31_CHANNEL_400_700NM = [
    39.52387622, 41.78260739, 43.71710988, 45.11623167, 46.30035537, 46.49899111, 47.17580019, 47.61406605, 47.51952076,
    48.72762724, 48.73404593, 50.70525556, 49.54251896, 50.26305817, 49.84265098, 49.42455289, 48.62886524, 49.06245476,
    48.07280128, 48.3340762, 48.62673229, 47.45452408, 47.00466159, 49.23973623, 46.00812168, 45.05571193, 45.26041172,
    43.49890985, 40.28837998, 41.36890754, 40.91668654
]


def refractive_index_noa61(wavelength, a=1.5375, b=0.00829045, c=-0.000211046):
    """ NOA61 dispersion formula
    https://refractiveindex.info/?shelf=other&book=Optical_adhesives&page=Norland_NOA61
    """
    return a + b / (wavelength * 1e6) ** 2 + c / (wavelength * 1e6) ** 4


def refractive_index_glass_bk7(wavelength):
    # dispersion formula
    wavelength_square = (wavelength * 1e6) ** 2
    # B1*λ^2 / (λ^2-C1)
    first = (1.03961212 * wavelength_square) / (wavelength_square - 0.00600069867)
    # B2*λ^2 / (λ^2-C2)
    second = (0.231792344 * wavelength_square) / (wavelength_square - 0.0200179144)
    # B3*λ^2 / (λ^2-C3)
    third = (1.01046945 * wavelength_square) / (wavelength_square - 103.560653)
    return ((first + second + third) + 1) ** 0.5


def refractive_index_glass_ohara_sk1300(wavelength):
    wavelength_square = (wavelength * 1e6) ** 2
    # B1*λ^2 / (λ^2-C1)
    first = (7.44386780E-01 * wavelength_square) / (wavelength_square - 4.95119834E-03)
    # B2*λ^2 / (λ^2-C2)
    second = (3.60198890E-01 * wavelength_square) / (wavelength_square - 1.41130274E-02)
    # B3*λ^2 / (λ^2-C3)
    third = (9.18623119E-01 * wavelength_square) / (wavelength_square - 1.00428510E+02)
    return ((first + second + third) + 1) ** 0.5


MATERIAL_REFRACTIVE_INDEX_FUNCS = {
    "NOA61": refractive_index_noa61,
    "BK7": refractive_index_glass_bk7,
    "SK1300": refractive_index_glass_ohara_sk1300
}

